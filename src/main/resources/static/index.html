<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>ã‚²ãƒ¼ãƒ åˆ¶ä½œ ã‚¿ã‚¹ã‚¯ç®¡ç†</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }

        .task-card {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <h1>ğŸ® ã‚²ãƒ¼ãƒ åˆ¶ä½œ ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒœãƒ¼ãƒ‰</h1>

    <div style="margin-bottom: 20px;">
        <input type="text" id="taskTitle" placeholder="ã‚¿ã‚¹ã‚¯åï¼ˆä¾‹ï¼šBGMä½œæˆï¼‰">
        <input type="number" id="taskHours" placeholder="å·¥æ•°ï¼ˆæ™‚é–“ï¼‰" style="width: 100px;">
        <button onclick="addTask()">ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ </button>
    </div>

    <div id="taskList"></div>

    <script>
        // â‘  ç”»é¢ãŒé–‹ã„ãŸæ™‚ã«ã€APIã‹ã‚‰ã‚¿ã‚¹ã‚¯ä¸€è¦§ã‚’å–å¾—ã™ã‚‹
        async function fetchTasks() {
            const response = await fetch('/api/tasks'); // ã‚ãªãŸãŒä½œã£ãŸGET APIã‚’å‘¼ã³å‡ºã™ï¼
            const tasks = await response.json();

            const listDiv = document.getElementById('taskList');
            listDiv.innerHTML = ''; // ä¸€æ—¦ä¸­èº«ã‚’ç©ºã«ã™ã‚‹

            tasks.forEach(task => {
                listDiv.innerHTML += `
                    <div class="task-card">
                        <strong>ID: ${task.id} | ${task.title}</strong>
                        <span style="color: gray;"> (å·¥æ•°: ${task.estimatedHours}h / çŠ¶æ…‹: ${task.status})</span>
                    </div>
                `;
            });
        }

        // â‘¡ ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã«ã€APIã¸æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’é€ä¿¡ã™ã‚‹
        async function addTask() {
            const titleInput = document.getElementById('taskTitle').value;
            const hoursInput = document.getElementById('taskHours').value;

            if (!titleInput) return alert("ã‚¿ã‚¹ã‚¯åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

            const newTask = {
                title: titleInput,
                description: "",
                assignee: "æœªå®š",
                status: "TODO",
                estimatedHours: hoursInput ? parseInt(hoursInput) : 0
            };

            await fetch('/api/tasks', { // ã‚ãªãŸãŒä½œã£ãŸPOST APIã‚’å‘¼ã³å‡ºã™ï¼
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(newTask)
            });

            // é€ä¿¡ãŒçµ‚ã‚ã£ãŸã‚‰ã€å…¥åŠ›æ¬„ã‚’ç©ºã«ã—ã¦ä¸€è¦§ã‚’å†å–å¾—
            document.getElementById('taskTitle').value = '';
            document.getElementById('taskHours').value = '';
            fetchTasks();
        }

        // ç”»é¢ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰æœ€åˆã«å®Ÿè¡Œã™ã‚‹
        fetchTasks();
    </script>
</body>

</html>